# Template Excel 生成器
b站搜索单纯炫压抑和0萝娃娃宙 这两个女的是我这辈子见过最神的神人
这个脚本用于将 `template.json` 文件中的数据转换为 Excel 格式。

## 功能特性

- 读取 `template.json` 文件
- 将 JSON 数据转换为结构化的 Excel 表格
- 自动设置合适的列宽
- 生成数据统计报告
- 支持中文字段名

## 安装依赖

```bash
npm install
```

## 使用方法

### 方法1：直接运行
```bash
node generate_excel.js
```

### 方法2：使用npm脚本
```bash
npm start
# 或者
npm run generate
```

## 输出文件

脚本会生成以下文件：
- `template_data.xlsx` - 主要的Excel数据文件

## 数据字段说明

生成的Excel文件包含以下字段：

| 字段名 | 说明 | 示例 |
|--------|------|------|
| 模板ID | 模板的唯一标识符 | 1952924779895853056 |
| 主用户ID | 主用户ID | 12400084333 |
| 模板名称 | 模板的名称 | "4%" |
| 客户ID | 客户ID | 1952924740381315072 |
| 客户名称 | 客户名称 | "云之谷快手" |
| 策略类型 | 策略类型编号 | 1 |
| 公返比例 | 公返比例百分比 | "4" |
| 私返比例 | 私返比例百分比 | "" |
| 备注 | 备注信息 | "" |
| 关联广告数量 | 关联的广告数量 | 0 |
| 媒体广告数量 | 各媒体的广告数量 | "mediumkuaishou: 5" |
| 唯一标识 | 唯一标识符 | "5106" |
| 市场ID | 市场ID | 0 |
| 市场名称 | 市场名称 | "" |
| 创建时间 | 创建时间 | "2025-08-06 10:48:46" |
| 更新时间 | 更新时间 | "2025-08-06 10:48:46" |
| 创建用户ID | 创建用户ID | 12400084979 |
| 更新用户ID | 更新用户ID | 12400084979 |

## 统计报告

脚本运行时会输出以下统计信息：
- 总记录数
- 策略类型分布
- 有媒体广告数量的记录数
- 公返比例分布

## 自定义配置

如果需要修改输出文件名或添加其他功能，可以编辑 `generate_excel.js` 文件中的相关函数。

## 注意事项

1. 确保 `template.json` 文件存在于脚本同目录下
2. 确保有足够的磁盘空间来生成Excel文件
3. 如果数据量很大，生成过程可能需要一些时间

## 错误处理

脚本包含完整的错误处理机制：
- 文件读取错误处理
- JSON解析错误处理
- Excel生成错误处理

如果遇到问题，请检查：
1. `template.json` 文件是否存在且格式正确
2. 是否已安装所有依赖包
3. 是否有足够的权限写入文件

