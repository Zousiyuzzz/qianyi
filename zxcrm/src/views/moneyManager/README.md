# 资金准备管理页面功能说明

## 新增功能

### 1. 下载模板功能
- **功能描述**: 用户可以下载客户到账上传模板
- **使用方法**: 点击"下载模板"按钮即可下载Excel模板文件
- **模板文件**: `客户到账上传模板.xlsx`

### 2. 导入客户到账数据功能
- **功能描述**: 用户可以上传客户到账模板，系统会在前端解析数据并显示确认弹窗
- **使用方法**: 点击"导入客户到账数据"按钮，选择填写好的模板文件
- **解析规则**: 
  - 从Excel文件的第二行开始解析数据（第二行为表头）
  - 从第三行开始读取实际数据
  - 支持Excel格式文件（.xlsx, .xls）
  - 文件大小限制：10MB以内
  - 前端解析，无需上传到服务器
- **确认流程**:
  - 前端解析完成后会弹出确认弹窗
  - 可以在弹窗中查看和编辑数据
  - 支持删除不需要的数据行
  - 确认无误后点击"确认导入"提交数据到服务器

### 3. 数据解析说明
系统会解析以下字段：
- 项目名称
- 合作方式（预付/垫付/服务费）
- 到账金额
- 到账时间
- 资金性质（对公/对私）
- 项目主体
- 我方抬头
- 备注

### 4. 后端API接口
需要后端提供以下接口：
- `GET /projectFundReserve/downloadTemplate` - 下载模板
- `POST /projectFundReserve/importCustomerArrivalTemplate` - 导入客户到账数据
  - 接收 `data` 参数（JSON格式的数据列表）
  - 执行实际的数据导入操作

### 5. 导入参数
**前端解析阶段**:
- 使用xlsx库在前端解析Excel文件
- 从第二行读取表头，从第三行开始读取数据
- 自动映射字段名称

**确认导入参数**:
- `data`: JSON格式的数据列表
- `templateType`: 'customerArrival' (指定模板类型)

## 注意事项
1. 请确保上传的Excel文件格式正确
2. 数据从第二行开始解析（第二行为表头），从第三行开始读取数据
3. 导入成功后会自动刷新页面数据
4. 如果导入失败，请检查文件格式和数据内容
5. 在确认弹窗中可以编辑数据，支持下拉选择和日期选择
6. 可以删除不需要的数据行

## 功能流程
1. 用户点击"下载模板"下载Excel模板
2. 用户填写模板数据
3. 用户点击"导入客户到账数据"上传文件
4. 前端解析Excel文件并显示确认弹窗
5. 用户在弹窗中查看、编辑或删除数据
6. 用户点击"确认导入"提交数据到服务器
7. 系统保存数据并刷新页面列表 